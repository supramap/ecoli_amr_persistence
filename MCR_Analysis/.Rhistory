lhs == "bleO" |)
lhs == "bleO" |)
View(mcr_rules_df %>%
)
View(mcr_rules_df %>%
filter(lhs == "aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB" |
lhs == "blaEC,floR,qnrS1" |
lhs == "aph(3')-Ia,blaEC,floR,tet(A)" |
lhs == "floR" |
lhs == "oqxB" |
lhs == "aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3" |
lhs == "aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)" |
lhs == "bleO" |
lhs == "blaEC,sul3,tet(A)" |
lhs == "qnrS2" |
lhs == "sul3" |
lhs == "fosA3" |
lhs == "aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)" |
lhs == "oqxB2"))
collapse("a,b",",")
split("a,b",",")
split("a,b",sep = ",")
unlist(strsplit("a,b,c", split=","))
## Create empty dataframe
mcr_rules_df <- data.frame(
lhs = character(0),
rhs = character(0),
size = numeric(0),
support = numeric(0),
confidence = numeric(0),
lift = numeric(0),
count = numeric(0)
)
for (i in 1:nrow(rulespace)){
## Get rule size and support metric for this iteration
size <- rulespace$rulesize[i]
numerator <- rulespace$isolatesize[i]
cat("Testing rules of size:", size, "\n")
## Generate MCR Rules
mcr_rules<- apriori(mcr.transactions,
parameter = list(minlen = size,
maxlen = size,
support = 0.001,
#support = 5*(numerator/length(amr.list.raw)),
confidence =  0.50,
maxtime = 60),
appearance = list(default = "none",
lhs = genotypes[which(genotypes != "mcr")],
rhs = "mcr"),
control = list(memopt = FALSE)
)
if (length(mcr_rules) > 0){
## Convert to dataframe
mcr_rules_df_iter <- data.frame(
lhs = labels(lhs(mcr_rules)),
rhs = labels(rhs(mcr_rules)),
size = size,
mcr_rules@quality
)
## Append this iterations's results to main dataframe
mcr_rules_df <- rbind(mcr_rules_df,
mcr_rules_df_iter)
}
}
## Remove brackets and convert all sets to lists
mcr_rules_df$lhs <- mcr_rules_df$lhs %>%
str_replace_all(c("\\{|\\}"),"") %>%
strsplit(split=",") %>%
unlist()
## Remove brackets and convert all sets to lists
mcr_rules_df$lhs <- mcr_rules_df$lhs %>%
str_replace_all(c("\\{|\\}"),"") %>%
strsplit(split=",") #%>%
View(mcr_rules_df)
mcr_rules_df$rhs <- mcr_rules_df$rhs %>%
str_replace_all(c("\\{|\\}"),"")
mcr_rules_df[1,1]
mcr_rules_df[7,1]
matches <- mcr_rules_df %>%
filter(lhs == unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=",")) |
lhs == unlist(strsplit("blaEC,floR,qnrS1", split=",")) |
lhs == unlist(strsplit("aph(3')-Ia,blaEC,floR,tet(A)", split=",")) |
lhs == unlist(strsplit("floR", split=",")) |
lhs == unlist(strsplit("oqxB", split=",")) |
lhs == unlist(strsplit("aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3", split=",")) |
lhs == unlist(strsplit("aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)", split=",")) |
lhs == unlist(strsplit("bleO", split=",")) |
lhs == unlist(strsplit("blaEC,sul3,tet(A)", split=",")) |
lhs == unlist(strsplit("qnrS2", split=",")) |
lhs == unlist(strsplit("sul3", split=",")) |
lhs == unlist(strsplit("fosA3", split=",")) |
lhs == unlist(strsplit("aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)", split=",")) |
lhs == unlist(strsplit("oqxB2", split=",")))
matches <- mcr_rules_df %>%
filter(lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=",")) |
lhs %in% unlist(strsplit("blaEC,floR,qnrS1", split=",")) |
lhs %in% unlist(strsplit("aph(3')-Ia,blaEC,floR,tet(A)", split=",")) |
lhs %in% unlist(strsplit("floR", split=",")) |
lhs %in% unlist(strsplit("oqxB", split=",")) |
lhs %in% unlist(strsplit("aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3", split=",")) |
lhs %in% unlist(strsplit("aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)", split=",")) |
lhs %in% unlist(strsplit("bleO", split=",")) |
lhs %in% unlist(strsplit("blaEC,sul3,tet(A)", split=",")) |
lhs %in% unlist(strsplit("qnrS2", split=",")) |
lhs %in% unlist(strsplit("sul3", split=",")) |
lhs %in% unlist(strsplit("fosA3", split=",")) |
lhs %in% unlist(strsplit("aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)", split=",")) |
lhs %in% unlist(strsplit("oqxB2", split=",")))
View(matches)
lhs %in% unlist(strsplit("sul3", split=","))
mcr_rules_df$lhs %in% unlist(strsplit("sul3", split=","))
c("sul3") %in% unlist(strsplit("sul3", split=","))
c("sel1, sul3") %in% unlist(strsplit("sul3", split=","))
c("sel1", "sul3") %in% unlist(strsplit("sul3", split=","))
c("sel1", "sul3") %in% unlist(strsplit("sul3, sul2", split=","))
c("a", "b") %in% c("a", "c")
subset(c("a","b"), c("a"))
length(mcr_rules_df$lhs)
all(c("a","b") %in% c("a", "c"))
all(c("a","b") %in% c("a"))
all(c("a","b") %in% c("a", "b", "c"))
matches <- mcr_rules_df %>%
filter(all(lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=","))) |
all(lhs %in% unlist(strsplit("blaEC,floR,qnrS1", split=","))) |
all(lhs %in% unlist(strsplit("aph(3')-Ia,blaEC,floR,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("floR", split=","))) |
all(lhs %in% unlist(strsplit("oqxB", split=","))) |
all(lhs %in% unlist(strsplit("aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3", split=","))) |
all(lhs %in% unlist(strsplit("aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("bleO", split=","))) |
all(lhs %in% unlist(strsplit("blaEC,sul3,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("qnrS2", split=","))) |
all(lhs %in% unlist(strsplit("sul3", split=","))) |
all(lhs %in% unlist(strsplit("fosA3", split=","))) |
all(lhs %in% unlist(strsplit("aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("oqxB2", split=","))))
matches <- mcr_rules_df %>%
filter_if(all(lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=","))) |
all(lhs %in% unlist(strsplit("blaEC,floR,qnrS1", split=","))) |
all(lhs %in% unlist(strsplit("aph(3')-Ia,blaEC,floR,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("floR", split=","))) |
all(lhs %in% unlist(strsplit("oqxB", split=","))) |
all(lhs %in% unlist(strsplit("aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3", split=","))) |
all(lhs %in% unlist(strsplit("aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("bleO", split=","))) |
all(lhs %in% unlist(strsplit("blaEC,sul3,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("qnrS2", split=","))) |
all(lhs %in% unlist(strsplit("sul3", split=","))) |
all(lhs %in% unlist(strsplit("fosA3", split=","))) |
all(lhs %in% unlist(strsplit("aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("oqxB2", split=","))))
matches <- mcr_rules_df[all(lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=","))) |
all(lhs %in% unlist(strsplit("blaEC,floR,qnrS1", split=","))) |
all(lhs %in% unlist(strsplit("aph(3')-Ia,blaEC,floR,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("floR", split=","))) |
all(lhs %in% unlist(strsplit("oqxB", split=","))) |
all(lhs %in% unlist(strsplit("aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3", split=","))) |
all(lhs %in% unlist(strsplit("aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("bleO", split=","))) |
all(lhs %in% unlist(strsplit("blaEC,sul3,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("qnrS2", split=","))) |
all(lhs %in% unlist(strsplit("sul3", split=","))) |
all(lhs %in% unlist(strsplit("fosA3", split=","))) |
all(lhs %in% unlist(strsplit("aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("oqxB2", split=","))),]
matches <- mcr_rules_df[all(mcr_rules_df$lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=","))) |
all(mcr_rules_df$lhs %in% unlist(strsplit("blaEC,floR,qnrS1", split=","))) |
all(mcr_rules_df$lhs %in% unlist(strsplit("aph(3')-Ia,blaEC,floR,tet(A)", split=","))) |
all(mcr_rules_df$lhs %in% unlist(strsplit("floR", split=","))) |
all(mcr_rules_df$lhs %in% unlist(strsplit("oqxB", split=","))) |
all(mcr_rules_df$lhs %in% unlist(strsplit("aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3", split=","))) |
all(mcr_rules_df$lhs %in% unlist(strsplit("aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)", split=","))) |
all(mcr_rules_df$lhs %in% unlist(strsplit("bleO", split=","))) |
all(mcr_rules_df$lhs %in% unlist(strsplit("blaEC,sul3,tet(A)", split=","))) |
all(mcr_rules_df$lhs %in% unlist(strsplit("qnrS2", split=","))) |
all(mcr_rules_df$lhs %in% unlist(strsplit("sul3", split=","))) |
all(mcr_rules_df$lhs %in% unlist(strsplit("fosA3", split=","))) |
all(mcr_rules_df$lhs %in% unlist(strsplit("aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)", split=","))) |
all(mcr_rules_df$lhs %in% unlist(strsplit("oqxB2", split=","))),]
all(mcr_rules_df$lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=",")))
matches <- mcr_rules_df %>%
filter_all(all(lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=","))) |
all(lhs %in% unlist(strsplit("blaEC,floR,qnrS1", split=","))) |
all(lhs %in% unlist(strsplit("aph(3')-Ia,blaEC,floR,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("floR", split=","))) |
all(lhs %in% unlist(strsplit("oqxB", split=","))) |
all(lhs %in% unlist(strsplit("aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3", split=","))) |
all(lhs %in% unlist(strsplit("aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("bleO", split=","))) |
all(lhs %in% unlist(strsplit("blaEC,sul3,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("qnrS2", split=","))) |
all(lhs %in% unlist(strsplit("sul3", split=","))) |
all(lhs %in% unlist(strsplit("fosA3", split=","))) |
all(lhs %in% unlist(strsplit("aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)", split=","))) |
all(lhs %in% unlist(strsplit("oqxB2", split=","))))
## Write out the rules results
saveRDS(mcr_rules_df,
file = "mcr_rules.RDS")
write.csv(mcr_rules_df,
file = "mcr_rules.csv",
append = FALSE)
mcr_rules_df$lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=","))
any(mcr_rules_df$lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=","))))
any(mcr_rules_df$lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=",")))
sum(mcr_rules_df$lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=",")))
matches <- mcr_rules_df[mcr_rules_df$lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=",")),]
View(matches)
c("a","b","c") %in% c("a","b")
c(c"a","b","c") %in% c("a","b")
c(c("a","b"),"b","c") %in% c("a","b")
data.frame(c("a","b"),"b","c") %in% c("a","b")
data.frame(c("a","b"),"b","c")
data.frame(lhs = c("a","b"),"b","c")
data.frame(lhs = c(c("a","b"),"b","c"))
data.frame(lhs = c(("a","b"),"b","c"))
data.frame(lhs = c(c("a","b"),"b","c"))
matches <- mcr_rules_df[(mcr_rules_df$lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("blaEC,floR,qnrS1", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aph(3')-Ia,blaEC,floR,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("floR", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("oqxB", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("bleO", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("blaEC,sul3,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("qnrS2", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("sul3", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("fosA3", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("oqxB2", split=","))),]
View(matches)
matches <- mcr_rules_df[(mcr_rules_df$lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("blaEC,floR,qnrS1", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aph(3')-Ia,blaEC,floR,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("floR", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("oqxB", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("bleO", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("blaEC,sul3,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("qnrS2", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("sul3", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("fosA3", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("oqxB2", split=","))) | #####
(unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=",")) %in% mcr_rules_df$lhs) |
(mcr_rules_df$lhs %in% unlist(strsplit("blaEC,floR,qnrS1", split=",")) %in% mcr_rules_df$lhs) |
(mcr_rules_df$lhs %in% unlist(strsplit("aph(3')-Ia,blaEC,floR,tet(A)", split=",")) %in% mcr_rules_df$lhs) |
(mcr_rules_df$lhs %in% unlist(strsplit("floR", split=",")) %in% mcr_rules_df$lhs) |
(mcr_rules_df$lhs %in% unlist(strsplit("oqxB", split=",")) %in% mcr_rules_df$lhs) |
(mcr_rules_df$lhs %in% unlist(strsplit("aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3", split=",")) %in% mcr_rules_df$lhs) |
(mcr_rules_df$lhs %in% unlist(strsplit("aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)", split=",")) %in% mcr_rules_df$lhs) |
(mcr_rules_df$lhs %in% unlist(strsplit("bleO", split=",")) %in% mcr_rules_df$lhs) |
(mcr_rules_df$lhs %in% unlist(strsplit("blaEC,sul3,tet(A)", split=",")) %in% mcr_rules_df$lhs) |
(mcr_rules_df$lhs %in% unlist(strsplit("qnrS2", split=",")) %in% mcr_rules_df$lhs) |
(mcr_rules_df$lhs %in% unlist(strsplit("sul3", split=",")) %in% mcr_rules_df$lhs) |
(mcr_rules_df$lhs %in% unlist(strsplit("fosA3", split=",")) %in% mcr_rules_df$lhs) |
(mcr_rules_df$lhs %in% unlist(strsplit("aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)", split=",")) %in% mcr_rules_df$lhs) |
(mcr_rules_df$lhs %in% unlist(strsplit("oqxB2", split=",")) %in% mcr_rules_df$lhs),]
matches <- mcr_rules_df[(mcr_rules_df$lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("blaEC,floR,qnrS1", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aph(3')-Ia,blaEC,floR,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("floR", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("oqxB", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("bleO", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("blaEC,sul3,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("qnrS2", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("sul3", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("fosA3", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("oqxB2", split=","))) | #####
(unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=",")) %in% mcr_rules_df$lhs) |
(unlist(strsplit("blaEC,floR,qnrS1", split=",")) %in% mcr_rules_df$lhs) |
(unlist(strsplit("aph(3')-Ia,blaEC,floR,tet(A)", split=",")) %in% mcr_rules_df$lhs) |
(unlist(strsplit("floR", split=",")) %in% mcr_rules_df$lhs) |
(unlist(strsplit("oqxB", split=",")) %in% mcr_rules_df$lhs) |
(unlist(strsplit("aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3", split=",")) %in% mcr_rules_df$lhs) |
(unlist(strsplit("aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)", split=",")) %in% mcr_rules_df$lhs) |
(unlist(strsplit("bleO", split=",")) %in% mcr_rules_df$lhs) |
(unlist(strsplit("blaEC,sul3,tet(A)", split=",")) %in% mcr_rules_df$lhs) |
(unlist(strsplit("qnrS2", split=",")) %in% mcr_rules_df$lhs) |
(unlist(strsplit("sul3", split=",")) %in% mcr_rules_df$lhs) |
(unlist(strsplit("fosA3", split=",")) %in% mcr_rules_df$lhs) |
(unlist(strsplit("aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)", split=",")) %in% mcr_rules_df$lhs) |
(unlist(strsplit("oqxB2", split=",")) %in% mcr_rules_df$lhs),]
View(matches)
matches <- mcr_rules_df[(mcr_rules_df$lhs %in% unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("blaEC,floR,qnrS1", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aph(3')-Ia,blaEC,floR,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("floR", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("oqxB", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("bleO", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("blaEC,sul3,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("qnrS2", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("sul3", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("fosA3", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)", split=","))) |
(mcr_rules_df$lhs %in% unlist(strsplit("oqxB2", split=","))) | #####
all(unlist(strsplit("aph(3'')-Ib,aph(6)-Id,blaEC,bleO,clpK,oqxA,oqxB", split=",")) %in% mcr_rules_df$lhs) |
all(unlist(strsplit("blaEC,floR,qnrS1", split=",")) %in% mcr_rules_df$lhs) |
all(unlist(strsplit("aph(3')-Ia,blaEC,floR,tet(A)", split=",")) %in% mcr_rules_df$lhs) |
all(unlist(strsplit("floR", split=",")) %in% mcr_rules_df$lhs) |
all(unlist(strsplit("oqxB", split=",")) %in% mcr_rules_df$lhs) |
all(unlist(strsplit("aadA1,aadA2,blaEC,cmlA1,dfrA12,qacL,sul3", split=",")) %in% mcr_rules_df$lhs) |
all(unlist(strsplit("aac(3)-IIa,aadA1,aph(3'')-Ib,aph(6)-Id,blaEC,dfrA1,qacEdelta1,sul1,tet(A)", split=",")) %in% mcr_rules_df$lhs) |
all(unlist(strsplit("bleO", split=",")) %in% mcr_rules_df$lhs) |
all(unlist(strsplit("blaEC,sul3,tet(A)", split=",")) %in% mcr_rules_df$lhs) |
all(unlist(strsplit("qnrS2", split=",")) %in% mcr_rules_df$lhs) |
all(unlist(strsplit("sul3", split=",")) %in% mcr_rules_df$lhs) |
all(unlist(strsplit("fosA3", split=",")) %in% mcr_rules_df$lhs) |
all(unlist(strsplit("aac(3)-IId,aadA5,aph(3'')-Ib,aph(6)-Id,blaCTX-M-65,blaEC,blaTEM-1,dfrA17,mph(A),qacEdelta1,sul1,sul2,tet(A)", split=",")) %in% mcr_rules_df$lhs) |
all(unlist(strsplit("oqxB2", split=",")) %in% mcr_rules_df$lhs),]
## Load in Packages
library(jsonlite)
library(tidyr)
library(dplyr)
## Read in Data
json.stream <- readRDS("e.coli.RDS")
## Get IDs
id <- json.stream[["ngout"]][["data"]][["content"]][["id"]] %>% as.data.frame()
colnames(id) <- "id"
## Separate IDs into PDG and PDT numbers
ids <- id %>% separate(id, c("pdg", "pdt"), sep = "_")
## Get BioProject numbers
bioprojects <- json.stream[["ngout"]][["data"]][["content"]][["bioproject_acc"]] %>% as.data.frame()
colnames(bioprojects) <- "bioproject"
bioprojects <- data.frame(ids, bioprojects)
bioprojects$bioproject_url <- paste0("https://www.ncbi.nlm.nih.gov/bioproject/",bioprojects$bioproject)
## Join to MCR Groups (from Odds Ratio Analysis)
mcr_groups <- read.csv("MCR_Groups_PDTs.csv")
bioprojects <- inner_join(mcr_groups, bioprojects)
######################
## Find all citations
library(rvest)
library(stringr)
library(reshape)
bioprojects_unique <- unique(bioprojects$bioproject)
publications <- data.frame(bioproject = character(0),
publications = character(0))
for (i in 1:length(bioprojects_unique)){
bioproject <- bioprojects_unique[i]
# content <- read_html(paste0("https://www.ncbi.nlm.nih.gov/bioproject/",
#                             bioprojects_unique[i])) %>%
#   html_nodes('#CombinedTable') %>%
#   html_table() %>%
#   .[[1]] %>%
#   filter(X1 == "Publications") %>%
#   select(X2)
content <- read_html(paste0("https://www.ncbi.nlm.nih.gov/bioproject/",
bioprojects_unique[i])) %>%
html_nodes("a.RegularLink") %>%
html_attr("href") %>%
as.data.frame() %>%
filter(str_detect(., "/pubmed/")) %>%
.[[1]] %>%
as.data.frame()
colnames(content) <- "publications"
if (length(content$publications) > 0){
iteroutput <- data.frame(bioproject = bioproject,
publications = content)
publications <- rbind(publications, iteroutput)
}
cat(paste0(i, ".BioProject: ", as.character(bioprojects_unique[i]), "\n"))
}
for (i in 78:length(bioprojects_unique)){
bioproject <- bioprojects_unique[i]
# content <- read_html(paste0("https://www.ncbi.nlm.nih.gov/bioproject/",
#                             bioprojects_unique[i])) %>%
#   html_nodes('#CombinedTable') %>%
#   html_table() %>%
#   .[[1]] %>%
#   filter(X1 == "Publications") %>%
#   select(X2)
content <- read_html(paste0("https://www.ncbi.nlm.nih.gov/bioproject/",
bioprojects_unique[i])) %>%
html_nodes("a.RegularLink") %>%
html_attr("href") %>%
as.data.frame() %>%
filter(str_detect(., "/pubmed/")) %>%
.[[1]] %>%
as.data.frame()
colnames(content) <- "publications"
if (length(content$publications) > 0){
iteroutput <- data.frame(bioproject = bioproject,
publications = content)
publications <- rbind(publications, iteroutput)
}
cat(paste0(i, ".BioProject: ", as.character(bioprojects_unique[i]), "\n"))
}
View(publications)
for (i in 111:length(bioprojects_unique)){
bioproject <- bioprojects_unique[i]
# content <- read_html(paste0("https://www.ncbi.nlm.nih.gov/bioproject/",
#                             bioprojects_unique[i])) %>%
#   html_nodes('#CombinedTable') %>%
#   html_table() %>%
#   .[[1]] %>%
#   filter(X1 == "Publications") %>%
#   select(X2)
content <- read_html(paste0("https://www.ncbi.nlm.nih.gov/bioproject/",
bioprojects_unique[i])) %>%
html_nodes("a.RegularLink") %>%
html_attr("href") %>%
as.data.frame() %>%
filter(str_detect(., "/pubmed/")) %>%
.[[1]] %>%
as.data.frame()
colnames(content) <- "publications"
if (length(content$publications) > 0){
iteroutput <- data.frame(bioproject = bioproject,
publications = content)
publications <- rbind(publications, iteroutput)
}
cat(paste0(i, ".BioProject: ", as.character(bioprojects_unique[i]), "\n"))
}
bioprojects_unique
for (i in 111:length(bioprojects_unique)){
bioproject <- bioprojects_unique[i]
# content <- read_html(paste0("https://www.ncbi.nlm.nih.gov/bioproject/",
#                             bioprojects_unique[i])) %>%
#   html_nodes('#CombinedTable') %>%
#   html_table() %>%
#   .[[1]] %>%
#   filter(X1 == "Publications") %>%
#   select(X2)
content <- read_html(paste0("https://www.ncbi.nlm.nih.gov/bioproject/",
bioprojects_unique[i])) %>%
html_nodes("a.RegularLink") %>%
html_attr("href") %>%
as.data.frame() %>%
filter(str_detect(., "/pubmed/")) %>%
.[[1]] %>%
as.data.frame()
colnames(content) <- "publications"
if (length(content$publications) > 0){
iteroutput <- data.frame(bioproject = bioproject,
publications = content)
publications <- rbind(publications, iteroutput)
}
cat(paste0(i, ".BioProject: ", as.character(bioprojects_unique[i]), "\n"))
}
bioproject <- bioprojects_unique[i]
View(bioprojects_unique)
length(bioprojects_unique)
bioprojects_unique <- unique(bioprojects$bioproject)
length(bioprojects_unique)
#publications_orig <- publications
## Derive URLS for Publications
publications$publication_url <- paste0("https://www.ncbi.nlm.nih.gov", publications$publications)
## Join Publications to PDT numbers via BioProject
publication_output <- inner_join(publications, bioprojects)
publications_by_mcr_group <- publication_output %>%
select(-c("pdt", "pdg", "publications", "bioproject")) %>%
unique() %>%
cast(publications_url~mcr_group)
View(publication_output)
colnames(publication_output)
## Join to MCR Groups (from Odds Ratio Analysis)
mcr_groups <- read.csv("MCR_Groups_PDTs.csv")
## Join to MCR Groups (from Odds Ratio Analysis)
mcr_groups <- read.csv("MCR_Groups_PDTs.csv")
colnames(publication_output$ï..mcr_group) <- "mcr_group"
colnames(publication_output$`ï..mcr_group`) <- "mcr_group"
colnames(publication_output) <- c("bioproject", "publications", "publication_url", "mcr_group", "pdt", "pdg", "bioproject_url"
)
colnames(publication_output)
publications_by_mcr_group <- publication_output %>%
select(-c("pdt", "pdg", "publications", "bioproject")) %>%
unique() %>%
cast(publications_url~mcr_group)
publications_by_mcr_group <- publication_output %>%
select(-c("pdt", "pdg", "publications", "publications_url", "bioproject")) %>%
unique() %>%
cast(publications_url~mcr_group)
publications_by_mcr_group <- publication_output %>%
select(-c("pdt", "pdg", "publications", "publication_url", "bioproject")) %>%
unique() %>%
cast(publications_url~mcr_group)
#publications_orig <- publications
## Derive URLS for Publications
publications$publication_url <- paste0("https://www.ncbi.nlm.nih.gov", publications$publications)
View(publications)
## Join Publications to PDT numbers via BioProject
publication_output <- inner_join(publications, bioprojects)
View(publication_output)
colnames(publication_output)
View(bioprojects)
colnames(bioprojects) <- c("mcr_group", "pdt", "pdg", "bioproject", "bioproject_url")
#publications_orig <- publications
## Derive URLS for Publications
publications$publication_url <- paste0("https://www.ncbi.nlm.nih.gov", publications$publications)
## Join Publications to PDT numbers via BioProject
publication_output <- inner_join(publications, bioprojects)
View(publication_output)
publications_by_mcr_group <- publication_output %>%
select(-c("pdt", "pdg", "publications", "publication_url", "bioproject")) %>%
unique() %>%
cast(publications_url~mcr_group)
publications_by_mcr_group <- publication_output %>%
select(-c("pdt", "pdg", "publications", "bioproject")) %>%
unique() %>%
cast(publications_url~mcr_group)
publications_by_mcr_group <- publication_output %>%
select(-c("pdt", "pdg", "publications", "bioproject")) %>%
unique() %>%
cast(publication_url~mcr_group)
View(publications_by_mcr_group)
write.csv(publications_by_mcr_group, "publications_by_mcr_group.csv")
